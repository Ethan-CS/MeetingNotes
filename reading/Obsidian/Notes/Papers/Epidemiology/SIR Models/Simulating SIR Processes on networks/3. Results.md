## Results

### Expected Propagation Time Between Node Pairs

_**Beginning at some given node, what is the expected time that, after this time, the disease reaches each other node in the network?**_

Answer to this question is encoded in the ensemble of weighted networks. For SI processes (i.e. $\gamma=0$) the expected propagation time is always finite and can be estimated as the average over $n$ samples of weighted networks as $$D_{ij}=\frac{1}{n}\sum^n_{k=1}f(\mathcal{G}_k),$$ where $f(\mathcal{G}_k)=d_{\mathcal{G}_k}(v_i, v_j)$ denotes length of weighted shortest path between $v_i$ and $v_j$. Note that for the SIR process, the expected propagation time diverges. The authors give Fig 5a - explicit example from perspective of specific source node. Advantage of temporal maps: encode this information between all possible node pairs. Result is given in Fig 5b-d. These plots show the average temporal distance or expected propagation time $D_{ij}$ for each pair of nodes $i,j,$ and thus encompass information about the expected spreading dynamics. In particular, they order the nodes by their _characteristic spreading timescale_ which is defined as expected time after which a given node infects $\bar{N}$ other nodes, $\tau_i,$ as $$\tau_i=t\rvert_{\sum_{j\neq i}\Theta (t-D_{ij})=\bar{N}}$$ where $\Theta(\cdot)$ is the Heaviside step function - one when $t\geq D_{ij}$ and zero otherwise. Small $\tau_i$ means that $i$ is of high importance or influence. This ordering of nodes displays the smooth gradient of the average temporal distance between pairs of nodes on all three empirical networks.


### Source Detection

_**For some snapshot $r^*$ of a spreading process at time $t_0$ on a network, how do we detect the source node that generated the snapshot?**_

Source detection is an important theoretical and practical problem in graph theory. It is at least as hard as any problem in the NP-complete class since it belongs to \#P-complete. Authors approach involves probabilistic kernel estimations of the likelihood that source node generated the observed snapshot. The framework presented can be used to perform this task as the ensemble of weighted networks encompasses information about different realisations of the spreading process from all possible sources.

For observed realisation $r^*$ the source probabiliy estimates for every node $v_i$ are constructed from ensemble averages $s_i \propto \sum^m_j f(\mathcal{G}_j).$ From weighted network $\mathcal{G}_j$ we extract realisation based on temporal distances and calculate the similarity $\phi_j \in [0, 1]$ to the observed realisation $r^*.$ Similarly, $\phi_j$ is the normalised number of equal corresponding states between two realisations. Finally, we use the Gaussian kernel function $$f(\mathcal{g}_j) = \exp(-(\phi_j-1)^2/a^2)$$ for probability estimations (see Supp. info 4). They compare source probability estimations with direct Monte Carlo approach and topological distance approach. The former generates a large number of simulations $n=10^6-10^8$ from each potential source node $v_i$ and source probability estimation is $s_i\propto n_i$ where $n_i$ is the number of simulations that match the observed realisation $r^*.$ The latter approach calculates the average topological distance $\langle d_i \rangle$ from each potential source $v_i$ to other infected nodes in the observed realisation $r^*$ and source estimation is $s_i\propto\langle d_i \rangle ^{-1}.$ The result is shown in Fig 6 where source ranked probability estimates for different methods are given. Indeedn, the method based on the ensemble of weighted networks ($n=10^5$ instances) performs better than a topological distance estimation and correctly assigns a high probability to the source candidate identified by the direct Monte Carlo method.


### Time Critical Vaccination

Now, consider following vaccination scenario. We observe at time $t_0$ the outbreak of a disease and we have a certain amount $m$ of vaccines (see Fig 7a). We can vaccinate $m$ individuals instantaneously but the vaccines will only be effective after some time $\Delta t$ (vaccinated individual can get infected before $t_0\Delta t$) and in this case the vaccine portion is wasted (see Fig. 7b). Who shall we vaccinate? The provided framework can be used to improve the vaccination strategy. Idea: at time $t_0$ we vaccinate only individuals who with high probability will not get infected before $t_0 + \Delta t.$ Hence, we estimate the probability that a node $i$ won't be infected before $t_0+\Delta t$ as $$\tilde{p}_i=/frac{1}{n}\sum^n_{k=1}\Theta(d_{\mathcal{G}_k}(v_{\theta}, v_i)-t_0-\Delta t),$$ where $\theta$ denotes the source node and here $\Theta(\cdot)$ is 1 when $d_{\mathcal{G}_k}(v_{\theta}, v_i)\geq t_0 + \Delta t$ and 0 otherwise. We vaccinate nodes proportional to $\tilde{p}.$ Fig 7b,c show, using empirical Petster network that this procedure better than randomly choosing from all susceptible nodes at $t_0$. Vaccinating proportional to degree (hubs strategy) performs worse than the fully random strategy as the hubs usually are infected earlier, which increases the chance to waste vaccine portions.