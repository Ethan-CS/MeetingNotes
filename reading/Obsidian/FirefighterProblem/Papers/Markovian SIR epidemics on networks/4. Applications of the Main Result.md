## 4. Applications of the main result

This section gives an example for a specific network, the star-triangle (fig 1g). They write and program the exact system and compare the results based on the ODEs to results from Gillespie-type simulation. With an upper bound on number of equations needed for an exact representation for networks with non-overlapping loops of at most size 3, we know that overlap via edges is not allowed. Importantly, they generalise applicability of reduction by closure technique for arbitrary networks and provide an upper bound on the number of equations needed for an exact system.

### 4.1 Star-triangle network

In order to give details of usefulness of general result on the link between cut-vertices and closures, need to consider the model example of a star-triangle network. Suppose the triangles are labelled $1$ to $M$, the central node labelled 1 and exterior nodes (the $i^{\text{\it th}}$ triangle except the central node) in the $i^{\text{\it th}}$ triangle are $i_1, i_2$. Here, the reduced, exact system is given in Appendix 9. By considering the reduced system it is straightforward to see that the number of equations depends on the number of triangles. This dependency can be quantified by a multiplicative factor which gives the number of necessary equations for individual sub-triangles.

However, there is a significant difference in equation numbers when considering isolated or single subnetwork by itself or as part of larger network. In this case, as node 1 is a cut-vertex, the network will break into $M$ disjointed triangles when it is removed. For generating the reduced system at the network level, these disjointed triangles shouldn't be thought of as isolated triangles but rather as a part of the larger network. One isolated triangle requires 18 equations (6 for the nodes, as each can be $S$ or $I$, 6 for the edges as each can be either $SI$ or $IS$ and 6 triples since out of the 8 possible configurations, $SSS$ and $III$ are dynamically unimportant - see Appendix 6). But when a triangle is considered in the context of the wider graph, we must extend the 18 equations to include differential equations for $SS$-type edges where at least one of the end nodes is a cut-vertex. Claim: this accounts for infections outside of the triangle. We need to account for the $SSS$ triple in our equations to capture infection coming from a cut-vertex from outside. This extension procedure in our context requires an extra 3 equation - two for the edges, one for the triples. Equation for $\langle S_{i_{1}}S_{i_{2}} \rangle$ is not required as this pair can't be infected from outside. In summary, the reduced system seems to require $21M$ equations, but the cut-vertex (node 1) has a multiplicity $M$ and hence $\langle S_1 \rangle$ and $\langle I_1 \rangle$ appear $M$ times although they are only needed once. Hence, the final number of equations in the reduced system is $21M-2(M-1)=19M+2$.

We can program these $19M+2$ equations in a systematic way, which gives an exact representation of the SIR dynamics on the star triangle network. They plot the numerical solutions of resulting system of ODEs to simulation results in Fig 6 and find that the plot shows good agreement and supports main result of the paper (that closures are exact, hence the ODE representation is exact). Fig 6 also shows that distributing the same number of infected nodes differently gives rise to different dynamics and further that distributing the index cases in a more random (or less regular) way gives a larger epidemic in the highly structured network we have been considering.


### 4.2 General networks with loops of maximum size 3

Star-triangle discussed above satisfies this constraint (loops of max size 3). However, now aim to prove a much more general statement for a wider class of networks. If a network has loops no larger than size 3, i.e. triangles cannot have overlapping edges, we can give an upper bound on the size of the system of equations describing the dynamics of such a system.

**Theorem 2** _Consider a network_ $N$ _nodes,_ $E$ _edges_, $T$ _triangles and no larger loops. The number of equations needed to fully describe the system dynamics is less than_ $2N + 3E + 7T \leq 10N$.

Proof follows for the rest of p.13 to top of p.15. They then give an example for the lollipop network to illustrate.


### Feasibility of the reduction by closure technique for general networks

The paper then details a recipe-like approach to determine whether it could be feasible to write down an exact representation for a given network. For a given network $G=\{V,E\}$ the following steps should be taken:
1. Final all cut-vertices of $G$ by using the _depth-first search_ algorithm and denote these by $C=\{v_{i_{1}}, v_{i_{2}}, \dots , v_{i_{L}}\}\subset V$. This algorithm runs in polynomial time in ($|E| + |V|$).
2. Splice the original network into independent subnetworks (each subnetwork is well-connected, but any two are disconnected) as determined by the number of properties of cut-vertices. We assume that this procedure leads to a family of distinct subnetworks denoted $G_1, G_2, \dots , G_P$, where $G_i=\{V_i,E_i\}$ with $i=1,2,\dots,P$, and each of these with frequency (or counts) given by $f_1, f_2, \dots , f_P$ respectively. This can be done so that cut-vertices are maintained in all subnetworks they generate. Denote the number of subnetworks that cut-vertex $v_{i_j}$ belongs to by $\text{Ind}(v_{i_j})$ where $j=1,2,\dots,L$. Then, _the subnetwork is a generalisation of the loop concept in that it needs to be connected and with no further cut-vertices. As indicated by above results, closures within loops or subnetworks will not be exact._
3. The relation between the distinct subnetworks $P$, their frequency and the number of nodes in the subnetworks (e.g. $|V_1|, |V_2|, \dots, |V_P|$) will determine number of equations required for a full and exact representation. This relation is made more precise by the corresponding multipliers $m_1, m_2, \dots, m_P$ which denote the number of equations required to describe exactly the corresponding subnetworks. For instance, an edge needs 7 equations - 4 for the nodes and 3 at the pair level. Similarly, a triangle requires 22 equations (6 for the nodes, 9 for the edges, 7 for the triangles), a cycle graph with 4 nodes requires 45 and the toast network needs 57. Thus, an upper bound for the number of equations required to describe the epidemic dynamics exactly is given by

$$
\displaystyle 
N_{EQ}(G) = \sum^P_{i=1}m_if_i - 2\sum^L_{j=1}(\text{Ind}(v_{i_j})-1)
$$
This formula takes a sum across the number of equations required for all subnetworks and adjusts this to account for the unnecessary multiplications caused by cut-vertices being part of multiple subnetworks. Using this for simple cases of tree-like networks yields $N_{EQ}(G)=2|V| +3|E|$. Moreover, for tree-like networks with only triangles, removing all cut-vertices will leave subnetworks of two distinct types - the edge and triangle - which gives $N_{EQ}(G) = 2|V| + 3|E| + 7T$ equations, where (as before) $T$ is the number of triangles in the network.

Note that $N_{EQ}$ is an upper bound since it accounts for all $SS$ pairs, regardless of whether (the original paper says 'weather' here) they are all required to link all subnetworks. In a similar way, we may need to have other fully susceptible arrangements in higher levels to account for outside infections. Author investigations show that removing unnecessary $SS$ variables won't substantially decrease number of equations.

Two extreme scenarios for decomposition of a network:
1. Network has many cut-vertices and few distinct subnetworks but high frequency
2. Network decomposes to (relatively) few distinct but larger subnetworks

The tree-like networks are a good example for (1), where only subnetwork is the edge where each edge requires only 3 equations. Hence, few equations per subnetwork but many subnetworks. More structured networks will generally have distinct subnetworks of larger sizes; for these, an exact description will call for a larger number of equations. Hence, fewer subnetworks but many more equations per subnetwork.

Importantly, it is non-trivial to find a simple relation between subnetworks and number of equations required for an exact description - this is left to future work. Straightforward to see that desirable scenario for an exact representation is (1) and it's likely that here an exact description is indeed possible. Complexity quickly rises from 22 equations for a fully connected triangle to 57 for a subnetwork equivalent to a toast network (Table 2 gives equation numbers for these and further examples of small networks). Hence, both (1) and (2) call for a large number of equations. Generating and implementing such equations required for an exact description is prone to error: authors recommend development of an algorithmic approach, where equations can be generated automatically instead of by hand. Future work will consider such a general, automated procedure. The approach above leads us to believe that the family of networks with many cut-vertices are more amenable to this approach and it's likely that, for networks with few cut-vertices, writing down an exact system may be out of reach.